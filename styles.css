/* =========================================
   記録アプリ styles.css
   ========================================= */

/* ---- 基本色/トークン ---- */
:root{
  --bg:#f6f7fb;
  --panel:#fff;
  --text:#1f2328;
  --muted:#6b7280;
  --accent:#5b8def;
  --line:#e5e7eb;
  --radius:14px;

  /* セーフエリア（iOS） */
  --safe-top: env(safe-area-inset-top);
  --safe-right: env(safe-area-inset-right);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
}

/* ---- リセット/ベース ---- */
*{ box-sizing:border-box }
html,body{
  margin:0; padding:0;
  background:var(--bg); color:var(--text);
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;
  -webkit-text-size-adjust:100%;
  overflow-x:hidden; /* 端に文字がにじむ対策 */
}
a{ color:inherit; text-decoration:none }
small, .small{ color:var(--muted); font-size:12px }

/* ---- コンテナ ---- */
header{ position:sticky; top:0; z-index:5; background:var(--panel); border-bottom:1px solid var(--line) }
.head{
  max-width:min(1100px,96vw);
  margin:0 auto;
  display:flex; gap:10px; align-items:center; justify-content:space-between;
  padding:calc(10px + var(--safe-top)) max(8px, var(--safe-right)) 10px max(8px, var(--safe-left));
}
.brand{ font-weight:900 }
main{
  max-width:min(1100px,96vw);
  margin:14px auto;
  padding-left:max(0px, var(--safe-left));
  padding-right:max(0px, var(--safe-right));
}
.panel{
  background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); padding:12px
}

/* ---- タブ ---- */
nav.tabs{ display:flex; gap:8px; flex-wrap:wrap }
nav.tabs button{
  border:1px solid var(--line); background:#fff; border-radius:16px; padding:8px 14px; cursor:pointer;
}
nav.tabs button.active{
  background:var(--accent); border-color:var(--accent); color:#fff; font-weight:700;
}

/* ---- 共通UI ---- */
button{ font:inherit; border:1px solid var(--line); background:#fff; border-radius:10px; padding:8px 10px; cursor:pointer }
button.primary{ background:var(--accent); border-color:var(--accent); color:#fff; font-weight:700 }
button.danger{ border-color:#e2555a; color:#e2555a }
input,textarea,select{ font:inherit }
input[type="text"],input[type="date"],input[type="time"],input[type="month"]{
  width:100%; padding:8px 10px; border:1px solid var(--line); border-radius:10px; background:#fff
}
textarea{ width:100%; min-height:220px; padding:10px; border:1px solid var(--line); border-radius:12px; resize:vertical }

/* ---- レイアウトヘルパ ---- */
.grid{ display:grid; gap:14px }
@media (min-width:860px){ .grid-2{ grid-template-columns:1.1fr .9fr } }

/* ---- カレンダー（共通） ---- */
.calendar{ display:grid; grid-template-columns:repeat(7,1fr); gap:6px }
.wd,.day{ aspect-ratio:1/1; min-height:38px; display:flex; align-items:center; justify-content:center; border-radius:10px }
.wd{ color:var(--muted); font-weight:700 }
.wd.sun{ color:#e2555a; font-weight:800 }
.wd.sat{ color:#2563eb; font-weight:800 }
.day{ border:1px solid transparent; background:#fff; font-weight:700 }
.day.sun{ color:#e2555a }
.day.sat{ color:#2563eb }
.day.today{ outline:2px solid var(--accent) }
.day.sel{ background:var(--accent); color:#000 }
.day.has{ border-color:#c7d7ff; background:#f3f7ff }

/* ---- リスト/カード ---- */
.list{ display:flex; flex-direction:column; gap:8px; max-height:360px; overflow:auto }
.card{ border:1px solid var(--line); border-radius:12px; padding:8px; background:#fff; cursor:pointer }
.card small{ color:var(--muted) }

/* ---- 食事エリア ---- */
.meal-card{ border:1px solid var(--line); border-radius:10px; padding:10px; background:#fff }
.meal-row-inline{ display:grid; grid-template-columns:repeat(3,1fr); gap:10px }

/* =========================================
   スケジュール調整（帯カレンダー） c-*
   ========================================= */
.c-wrap{ margin-top:6px; border:1px solid #d9deea; border-radius:14px; overflow:hidden; background:#f9fafc }
.c-toolbar{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin:8px 0 }
.c-btn,.c-input,.c-select{ background:#fff; color:var(--text); border:1px solid #cfd6ea; border-radius:12px; padding:8px 10px }
.c-btn{ cursor:pointer }
.c-btn.primary{ background:linear-gradient(135deg,#5b8def,#8e88ff); border:none; color:#fff }
.c-viewtabs{ display:flex; background:#fff; border:1px solid #cfd6ea; border-radius:12px; overflow:hidden }
.c-viewtabs button{ border:none; background:transparent; color:#617197; padding:8px 10px; cursor:pointer }
.c-viewtabs button.active{ color:#12203a; background:#eef2ff }
.c-legend{ display:flex; gap:12px; flex-wrap:wrap; margin:6px 0 10px; color:#617197; font-size:12px }
.c-legend .dot{ width:14px; height:8px; border-radius:4px; display:inline-block }
.c-badge{ font-size:12px; color:#0b0c10; background:#eef2ff; padding:2px 8px; border-radius:999px; border:1px solid #c7d7ff; font-weight:700 }

/* week */
.c-week{ border-top:1px solid #d9deea }
.c-week-head{ display:grid; grid-template-columns:80px repeat(7,1fr); background:#eef2ff; border-bottom:1px solid #d9deea; overflow:hidden }
.c-whcell{ padding:8px; border-left:1px solid #d9deea }
.c-whcell:first-child{ border-left:none }
.c-whday{ font-weight:800 }
.c-whdate{ color:#617197; font-size:12px }

.c-week-grid{
  position:relative;
  display:grid; grid-template-columns:80px repeat(7,1fr);
  height:900px;
  background:linear-gradient(180deg,#fff, #f8f9fd);
  overflow:hidden; box-sizing:border-box; /* はみ出し対策 */
}
.c-col{ position:relative; border-left:1px solid #eef1f7 }
.c-col:first-child{ border-left:none }
.c-timecol{ background:#f3f6ff }

/* 時間の水平グリッド */
.c-week-grid .c-col:not(.c-timecol)::before{
  content:""; position:absolute; left:0; top:0; right:0; bottom:0;
  background:
    repeating-linear-gradient(to bottom,transparent,transparent 29px, rgba(0,0,0,.04) 30px),
    repeating-linear-gradient(to bottom,transparent,transparent 59px, rgba(0,0,0,.06) 60px);
  pointer-events:none;
}

/* 勤務帯（空けたい帯） */
.c-workband{ position:absolute; left:0; right:0; background:rgba(0,255,140,.08); outline:1px dashed rgba(0,255,140,.25); pointer-events:none }

/* event */
.c-event{
  position:absolute; left:4px; right:4px;
  border:1px solid #cfd6ea; border-radius:10px; background:#fff;
  box-shadow:0 6px 18px rgba(23,39,84,.08);
  padding:6px 8px; display:grid; gap:4px; cursor:pointer
}
.c-event .band{ position:absolute; inset:0 0 0 auto; width:6px; border-radius:0 10px 10px 0; opacity:.95 }
.c-event .title{ font-weight:700; font-size:14px }
.c-event .meta{ font-size:12px; color:#617197; display:flex; gap:10px; flex-wrap:wrap }
.c-event .status{ position:absolute; top:6px; right:8px }
.c-event[data-status="仮"]{ outline:2px dashed rgba(23,39,84,.18) }
.c-event[data-status="注意"]{ animation:c-blink 1.4s infinite }
@keyframes c-blink{ 0%,100%{ filter:brightness(1) } 50%{ filter:brightness(1.12) } }

/* month */
.c-month{ border-top:1px solid #d9deea }
.c-month-head{ display:grid; grid-template-columns:repeat(7,1fr); background:#eef2ff; border-bottom:1px solid #d9deea }
.c-month-grid{ display:grid; grid-template-columns:repeat(7,1fr); background:#f7f9ff }
.c-mday{ padding:8px; border-right:1px solid #e6ebf7; border-bottom:1px solid #e6ebf7; min-height:96px; background:#fff }
.c-mday:last-child{ border-right:none }
.c-mhead{ display:flex; justify-content:space-between; align-items:center }
.c-mb{ height:6px; border-radius:3px; margin-top:4px; opacity:.95 }

/* ---- モーダル（共通） ---- */
dialog.c-modal{
  width:min(680px,96vw);
  border:none; border-radius:16px; background:#fff; color:#12203a;
  box-shadow:0 12px 40px rgba(0,0,0,.15);
  padding:0; overflow:hidden
}
.c-modal-head{ display:flex; justify-content:space-between; align-items:center; padding:14px 16px; border-bottom:1px solid #e6ebf7 }
.c-modal-body{ padding:16px; display:grid; gap:12px }
.c-grid{ display:grid; gap:12px; grid-template-columns:1fr 1fr }
.c-grid-3{ display:grid; gap:12px; grid-template-columns:1fr 1fr 1fr }
.c-modal-foot{ display:flex; justify-content:space-between; align-items:center; padding:12px 16px; border-top:1px solid #e6ebf7; background:#f7f9ff }
.c-danger{ color:#c0392b; border-color:#e6a29b }

/* 既存モーダル（予定） */
dialog#dlg{
  width:min(520px,96vw);
  border:none; border-radius:16px; padding:0; overflow:hidden;
  box-shadow:0 12px 40px rgba(0,0,0,.15);
}
dialog#dlg .modal{ padding:16px; background:#fff }

/* ---- モバイル最適化（下タブ・タップしやすさ等） ---- */
@media (max-width: 720px){
  /* タブをボトムバーに */
  header .head{ padding-bottom:56px } /* 下バー分の余白 */
  nav.tabs{
    position:fixed; left:0; right:0; bottom:0; z-index:10;
    display:grid; grid-template-columns:repeat(4,1fr); gap:0;
    border-top:1px solid var(--line); background:#fff;
    padding:6px max(8px, var(--safe-right)) calc(6px + var(--safe-bottom)) max(8px, var(--safe-left));
  }
  nav.tabs button{ border:none; border-radius:0; padding:10px 6px; font-size:13px }
  main{ padding-bottom:calc(56px + var(--safe-bottom)) }

  /* タップターゲット拡大・週ビュー高さ可変 */
  :root{ --radius:16px }
  button, .c-btn{ padding:12px 14px; font-size:16px }
  input, select, textarea{ font-size:16px } /* iOSフォームズーム回避 */
  .day, .wd{ min-height:44px }
  .c-week-grid{ height:calc(100dvh - 140px) } /* 目安: ヘッダー等を控除。必要なら微調整 */
  .c-grid, .c-grid-3{ grid-template-columns:1fr } /* モーダルの入力を縦1列に */
}

/* ---- さらにタッチ端末専用の微調整（ポインタ特性） ---- */
@media (hover:none) and (pointer:coarse){
  .c-week-grid{ height: max(700px, 60vh) }
}

/* ---- 細かなユーティリティ ---- */
.badge{
  font-size:12px; padding:2px 8px; border-radius:999px;
  background:#eef2ff; color:#334155; border:1px solid #c7d7ff
}
hr{ border:0; border-top:1px solid var(--line); margin:10px 0 }
html,
body {
  margin: 0;
  padding: 0;
  max-width: 100%;
  overflow-x: hidden;
}

*, *::before, *::after {
  box-sizing: border-box;
}

/* iPhoneで中央に収めるラッパー */
.app-shell {
  max-width: 480px;        /* iPhone想定幅 */
  margin: 0 auto;
  padding: 8px 10px 16px;
}

/* カレンダーなどがはみ出さないように */
.calendar,
.panel,
header,
main {
  width: 100%;
}
.icon-btn {
  border: none;
  background: transparent;
  color: #c8d4e6;
  font-size: 20px;
  cursor: pointer;
  padding: 4px 6px;
  margin-left: 6px;
}

.icon-btn:hover {
  color: #ffffff;
}

